{% extends 'dashboard/_base.html' %}
{% load static %}

{% block stylesheet %}
    <link rel="stylesheet" href="{% static 'css/form.css' %}" type="text/css" media="screen, projection"/>
    <link rel="stylesheet" href="{% static 'css/dashboard/admin/form.css' %}" type="text/css" media="screen, projection"/>
    <style>
        form table td,
        form table th {
            border: none !important;
            padding: 10px;
        }

        #content-view .section {
            padding: 20px;
        }

        #content form {
            height: 100%;
        }

        input[type="text"]:disabled {
            background: white;
            border: none;
        }
    </style>
{% endblock stylesheet %}
{% block contentview %}
    <div id="content">
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="header box-shadow-bottom ">
                {{ dashboard_title|safe }}
                <div class="pull-right">
                    <button id="submit" class="main-button">Submit</button>
                </div>
            </div>
            <div id="content-view">
                <div class="section box-shadow-bottom">
                    {% csrf_token %}
                    <p>
                        <label class="label required" for="name">Harvester</label>
                        <select name="harvester" id="harvester-selection">
                            {% for harvester in harvesters %}
                                <option value="{{ harvester.value }}">{{ harvester.name }}</option>
                            {% endfor %}
                        </select>
                        <span id="harvester-description" class="helptext"></span>
                    </p>
                    <br>
                    <h3>Attributes</h3>
                    <table id="attributes-table" class="content-table">
                        <tr>
                            <th>Name</th>
                            <th>Value</th>
                        </tr>
                        {% for attribute in attributes %}
                            <tr>
                                <td style="width: 50%">{{ attribute.title }} <i class="fa fa-question-circle" aria-hidden="true" title="{{ attribute.description }}"></i></td>
                                <td style="width: 50%"><input type="text" name="attribute_{{ attribute.name }}" value="{{ attribute.value }}"></td>
                            </tr>
                        {% endfor %}
                    </table>

                    {% block additional_field %}
                    {% endblock %}
                </div>
            </div>
        </form>
    </div>
{% endblock %}
{% block scripts %}
    <script>
        const harvestersDescription = {};
        {% for harvester in harvesters %}
            harvestersDescription['{{ harvester.value }}'] = `{{ harvester.description|safe }}`;
        {% endfor %}

        const $harvesterSelection = $('#harvester-selection');
        $harvesterSelection.change(function () {
            {#console.log($(this).val());#}
        });
        $harvesterSelection.val('{{ harvester_class }}');
        const defaultDesc = harvestersDescription['{{ harvester_class }}'];
        $('#harvester-description').html(defaultDesc);
    </script>
    {% block extrascripts %}
    {% endblock %}
{% endblock %}